<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Statement Converter - PDF to Excel (Free & Secure)</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ†Ô∏è</text></svg>">
    <meta name="description"
        content="Convert PDF bank statements to Excel (XLSX) instantly in your browser. No upload required, 100% private and free.">
    <meta name="keywords"
        content="pdf to excel, bank statement converter, pdf to xlsx, free pdf converter, secure pdf tool, local pdf conversion">

    <!-- Canonical -->
    <link rel="canonical" href="https://allinone.page/tools/pdf-to-excel/">

    <!-- Hreflang -->
    <link rel="alternate" hreflang="en" href="https://allinone.page/tools/pdf-to-excel/" />
    <link rel="alternate" hreflang="zh" href="https://allinone.page/tools/pdf-to-excel/?lang=zh" />
    <link rel="alternate" hreflang="x-default" href="https://allinone.page/tools/pdf-to-excel/" />

    <!-- Open Graph -->
    <meta property="og:url" content="https://allinone.page/tools/pdf-to-excel/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Bank Statement Converter - PDF to Excel (Free & Secure)">
    <meta property="og:description"
        content="Convert PDF bank statements to Excel securely in your browser. No data upload needed.">
    <meta property="og:image" content="https://allinone.page/assets/og-image.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <!-- SheetJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            white-space: nowrap;
        }

        th,
        td {
            padding: 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            text-align: left;
        }

        th {
            background-color: #f9fafb;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #6b7280;
        }

        td {
            font-size: 0.875rem;
            color: #374151;
        }

        tr:hover {
            background-color: #f3f4f6;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-white py-4 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa-solid fa-screwdriver-wrench text-blue-600 text-2xl"></i>
                <a href="../../index.html" class="text-xl font-bold text-gray-900">allinone.page</a>
            </div>
            <div class="hidden md:flex items-center space-x-8 text-sm font-medium text-gray-600">
                <a href="../../index.html" class="hover:text-blue-600 transition" data-i18n="nav.home">Home</a>
                <a href="../../index.html#all-tools" class="hover:text-blue-600 transition"
                    data-i18n="nav.categories">Categories</a>
                <a href="../../about.html" class="hover:text-blue-600 transition" data-i18n="nav.about">About</a>

                <!-- Language Switcher -->
                <div class="flex items-center space-x-2 border-l pl-6 border-gray-300">
                    <button onclick="changeLanguage('en')" id="lang-en"
                        class="hover:text-blue-800 transition">EN</button>
                    <span class="text-gray-300">/</span>
                    <button onclick="changeLanguage('zh')" id="lang-zh"
                        class="hover:text-blue-800 transition">‰∏≠Êñá</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Tool Header -->
    <div class="bg-blue-600 text-white py-12 mb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-3xl font-bold mb-4" data-i18n="tool.pdf.title">Bank Statement Converter</h1>
            <p class="text-blue-100 max-w-2xl mx-auto" data-i18n="tool.pdf.desc">Convert PDF bank statements to Excel
                securely in your browser. No data upload.</p>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full">

        <!-- Upload Section -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8 mb-8 text-center transition-all"
            id="drop-zone">
            <input type="file" id="file-input" accept=".pdf" class="hidden">
            <div class="space-y-4 pointer-events-none">
                <div
                    class="w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fa-solid fa-file-invoice-dollar text-3xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900" data-i18n="pdf.drag.title">Drop PDF Statement Here</h3>
                <p class="text-gray-500" data-i18n="pdf.drag.subtitle">or click to select file</p>
                <button onclick="document.getElementById('file-input').click()"
                    class="pointer-events-auto bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-medium transition shadow-sm">
                    Select File
                </button>
            </div>
            <p class="mt-6 text-xs text-gray-400 flex items-center justify-center gap-1">
                <i class="fa-solid fa-lock"></i> <span data-i18n="pdf.note.privacy">Processed locally. Your data never
                    leaves this browser.</span>
            </p>
        </div>

        <!-- Processing State -->
        <div id="processing-state" class="hidden text-center py-12">
            <i class="fa-solid fa-circle-notch fa-spin text-4xl text-blue-600 mb-4"></i>
            <p class="text-lg font-medium text-gray-600" data-i18n="pdf.status.processing">Processing PDF...</p>
        </div>

        <!-- Result Section -->
        <div id="result-section" class="hidden">

            <!-- Toolbar -->
            <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4">
                <h2 class="text-lg font-bold text-gray-900 flex items-center">
                    <i class="fa-solid fa-table text-green-600 mr-2"></i> <span data-i18n="pdf.preview.title">Preview
                        Extracted Data</span>
                </h2>
                <div class="flex gap-3">
                    <button id="btn-download-excel"
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition shadow-sm flex items-center text-sm">
                        <i class="fa-solid fa-file-excel mr-2"></i> <span data-i18n="pdf.action.download_excel">Download
                            Excel</span>
                    </button>
                    <!-- CSV Optional -->
                    <!-- <button id="btn-download-csv" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium transition border border-gray-200 flex items-center text-sm">
                        <i class="fa-solid fa-file-csv mr-2"></i> CSV
                    </button> -->
                </div>
            </div>

            <!-- Table Preview -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden mb-12">
                <div class="table-responsive max-h-[600px]">
                    <table id="preview-table">
                        <!-- JS renders content here -->
                    </table>
                </div>
            </div>
        </div>

        <!-- Rich Content / FAQ -->
        <section class="max-w-4xl mx-auto mt-16 prose prose-blue text-gray-600 mb-12">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">How to Convert PDF Bank Statements to Excel?</h2>
            <p class="mb-4">Our <strong>PDF to Excel Converter</strong> is designed for privacy and speed. Unlike other
                tools that upload your sensitive financial documents to a server, this tool processes everything locally
                in your browser using WebAssembly technology.</p>
            <h3 class="text-xl font-bold text-gray-900 mb-2">Key Features:</h3>
            <ul class="list-disc pl-5 space-y-2 mb-6">
                <li><strong>100% Private:</strong> Your files never leave your device.</li>
                <li><strong>Fast:</strong> Instant conversion without queuing.</li>
                <li><strong>Free:</strong> No limits, no sign-up required.</li>
                <li><strong>Secure:</strong> Handles password-protected PDFs locally.</li>
            </ul>
            <h3 class="text-xl font-bold text-gray-900 mb-2">Frequently Asked Questions</h3>
            <div class="space-y-4">
                <div>
                    <h4 class="font-bold text-gray-800">Is my data safe?</h4>
                    <p class="text-sm">Yes, absolutely. All processing happens in your browser using JavaScript. No file
                        is ever uploaded to any server.</p>
                </div>
                <div>
                    <h4 class="font-bold text-gray-800">Can I convert encrypted PDFs?</h4>
                    <p class="text-sm">Yes, if you have the password, you can decrypt and convert them directly in the
                        browser.</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-100 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm text-gray-400">
            <span data-i18n="footer.rights">&copy; 2026 allinone.page. All rights reserved.</span>
        </div>
    </footer>

    <!-- Password Modal -->
    <div id="password-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-xl font-bold text-gray-900 mb-4" data-i18n="pdf.password.title">Password Required</h3>
            <p class="text-gray-600 mb-4" data-i18n="pdf.password.desc">This PDF is encrypted. Please enter the password
                to proceed.</p>

            <input type="password" id="pdf-password-input"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 mb-2"
                placeholder="Enter password" data-i18n-placeholder="pdf.password.placeholder">

            <p id="password-error" class="text-red-600 text-sm mb-4 hidden" data-i18n="pdf.password.incorrect">Incorrect
                password. Please try again.</p>

            <div class="flex justify-end gap-3 mt-4">
                <button id="btn-password-cancel"
                    class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium transition"
                    data-i18n="common.cancel">Cancel</button>
                <button id="btn-password-submit"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition shadow-sm"
                    data-i18n="common.submit">Submit</button>
            </div>
        </div>
    </div>

    <script src="../../js/i18n.js?v=5"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const dropZone = document.getElementById('drop-zone');
            const fileInput = document.getElementById('file-input');
            const processingState = document.getElementById('processing-state');
            const resultSection = document.getElementById('result-section');
            const previewTable = document.getElementById('preview-table');
            const btnDownloadExcel = document.getElementById('btn-download-excel');

            // Password Modal Elements
            const passwordModal = document.getElementById('password-modal');
            const passwordInput = document.getElementById('pdf-password-input');
            const passwordError = document.getElementById('password-error');
            const btnPasswordSubmit = document.getElementById('btn-password-submit');
            const btnPasswordCancel = document.getElementById('btn-password-cancel');

            let globalData = []; // Store 2D array of extracted data
            let passwordCallback = null; // To store the callback from pdf.js
            let currentFile = null; // Store file for retry

            // Drag & Drop Handlers
            function highlight() { dropZone.classList.add('border-blue-500', 'bg-blue-50'); }
            function unhighlight() { dropZone.classList.remove('border-blue-500', 'bg-blue-50'); }

            dropZone.addEventListener('dragover', (e) => { e.preventDefault(); highlight(); });
            dropZone.addEventListener('dragleave', unhighlight);
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                unhighlight();
                const file = e.dataTransfer.files[0];
                if (file && file.type === 'application/pdf') {
                    currentFile = file;
                    processFile(file);
                }
                else alert('Please upload a valid PDF file.');
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files[0]) {
                    currentFile = e.target.files[0];
                    processFile(e.target.files[0]);
                }
            });

            btnDownloadExcel.addEventListener('click', () => {
                if (globalData.length === 0) return;
                const ws = XLSX.utils.aoa_to_sheet(globalData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                XLSX.writeFile(wb, "bank_statement.xlsx");
            });

            // Password Modal Event Listeners
            btnPasswordSubmit.addEventListener('click', submitPassword);
            btnPasswordCancel.addEventListener('click', cancelPassword);
            passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') submitPassword();
            });

            function submitPassword() {
                const password = passwordInput.value;
                if (passwordCallback) {
                    passwordCallback(password);
                    // Legacy path: pdf.js callback deals with the rest
                } else if (currentFile) {
                    // Fallback path: restart process with password
                    passwordModal.classList.add('hidden'); // Hide temporarily so processFile controls it
                    processFile(currentFile, password);
                }
            }

            function cancelPassword() {
                passwordModal.classList.add('hidden');
                passwordInput.value = '';
                passwordError.classList.add('hidden');

                // Reset UI
                dropZone.classList.remove('hidden');
                processingState.classList.add('hidden');

                passwordCallback = null;
                currentFile = null;
            }

            async function processFile(file, password = null) {
                // UI Update
                dropZone.classList.add('hidden');
                processingState.classList.remove('hidden');
                resultSection.classList.add('hidden');

                // If this is a retry with password, hide modal if it's still open
                // (though logic above hides it)

                try {
                    const arrayBuffer = await file.arrayBuffer();

                    // Options for getDocument
                    const params = {
                        data: new Uint8Array(arrayBuffer), // Use Uint8Array for better compatibility
                        onPassword: function (updatePassword, reason) {
                            passwordCallback = updatePassword;

                            // Show modal
                            passwordModal.classList.remove('hidden');
                            passwordInput.focus();

                            if (reason === pdfjsLib.PasswordResponses.INCORRECT_PASSWORD) {
                                passwordError.classList.remove('hidden');
                            } else {
                                passwordError.classList.add('hidden');
                                passwordInput.value = '';
                            }
                        }
                    };

                    if (password) {
                        params.password = password;
                    }

                    const loadingTask = pdfjsLib.getDocument(params);
                    const pdf = await loadingTask.promise;

                    // If we reach here, password was correct or not needed
                    passwordModal.classList.add('hidden');
                    passwordInput.value = '';
                    passwordError.classList.add('hidden');
                    passwordCallback = null;

                    let allRows = [];

                    // Iterate Pages
                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();

                        // Extract text items with coordinates
                        const items = textContent.items.map(item => ({
                            str: item.str,
                            x: item.transform[4],
                            y: item.transform[5],
                            w: item.width,
                            h: item.height
                        }));

                        // Filter empty strings
                        const validItems = items.filter(it => it.str.trim() !== '');

                        // Group by Rows (Y-axis clustering)
                        const tolerance = 5;
                        const rowGroups = [];

                        // Sort by Y (descending - top of page first)
                        validItems.sort((a, b) => b.y - a.y);

                        if (validItems.length > 0) {
                            let currentRow = [validItems[0]];

                            for (let j = 1; j < validItems.length; j++) {
                                const item = validItems[j];
                                const prev = currentRow[0];

                                if (Math.abs(item.y - prev.y) < tolerance) {
                                    currentRow.push(item);
                                } else {
                                    rowGroups.push(currentRow);
                                    currentRow = [item];
                                }
                            }
                            rowGroups.push(currentRow);
                        }

                        // Process Row Groups into Data Rows
                        const pageRows = rowGroups.map(group => {
                            group.sort((a, b) => a.x - b.x);
                            return group.map(g => g.str);
                        });

                        allRows = allRows.concat(pageRows);
                    }

                    globalData = allRows;
                    renderTable(allRows);

                    processingState.classList.add('hidden');
                    resultSection.classList.remove('hidden');

                } catch (err) {
                    console.error(err);

                    // Handle "No password given" or PasswordException
                    // The error message "No password given" means pdf.js gave up
                    if (err.name === 'PasswordException' || err.message.includes('No password given')) {
                        // Activate Fallback Logic
                        passwordCallback = null; // No callback available since it died

                        passwordModal.classList.remove('hidden');
                        passwordInput.focus();

                        // If we provided a password and it failed:
                        if (password) {
                            passwordError.classList.remove('hidden');
                        } else {
                            passwordError.classList.add('hidden');
                            passwordInput.value = '';
                        }
                        return; // Wait for user interaction
                    }

                    alert('Error processing PDF: ' + err.message);
                    dropZone.classList.remove('hidden');
                    processingState.classList.add('hidden');
                    passwordModal.classList.add('hidden');
                }
            }

            function renderTable(data) {
                previewTable.innerHTML = '';
                const rowsToShow = data.slice(0, 100);
                rowsToShow.forEach((row, idx) => {
                    const tr = document.createElement('tr');
                    row.forEach(cellText => {
                        const cell = idx === 0 ? document.createElement('th') : document.createElement('td');
                        cell.textContent = cellText;
                        tr.appendChild(cell);
                    });
                    previewTable.appendChild(tr);
                });

                if (data.length > 100) {
                    const tr = document.createElement('tr');
                    const td = document.createElement('td');
                    td.colSpan = 10;
                    td.textContent = `... and ${data.length - 100} more rows. Download to see full data.`;
                    td.classList.add('text-center', 'italic', 'text-gray-400');
                    tr.appendChild(td);
                    previewTable.appendChild(tr);
                }
            }
        });
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Bank Statement Converter",
      "url": "https://allinone.page/tools/pdf-to-excel/",
      "description": "Convert PDF bank statements to Excel securely in your browser.",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
</body>

</html>