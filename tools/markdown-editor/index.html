<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown 实时预览 - 在线工具箱</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Marked 解析库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Markdown 预览的基本样式 */
        .prose h1 { font-size: 2em; font-weight: bold; margin-bottom: 0.5em; border-bottom: 1px solid #eee; padding-bottom: 0.3em; }
        .prose h2 { font-size: 1.5em; font-weight: bold; margin-top: 1em; margin-bottom: 0.5em; }
        .prose p { margin-bottom: 1em; line-height: 1.6; }
        .prose ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; }
        .prose ol { list-style-type: decimal; padding-left: 1.5em; margin-bottom: 1em; }
        .prose code { background-color: #f3f4f6; padding: 0.2em 0.4em; border-radius: 0.25em; font-family: monospace; font-size: 0.9em; color: #e01b24; }
        .prose pre { background-color: #1f2937; color: #f3f4f6; padding: 1em; border-radius: 0.5em; overflow-x: auto; margin-bottom: 1em; }
        .prose pre code { background-color: transparent; color: inherit; padding: 0; }
        .prose blockquote { border-left: 4px solid #e5e7eb; padding-left: 1em; color: #6b7280; font-style: italic; }
        .prose img { max-width: 100%; height: auto; border-radius: 0.5em; }
        .prose a { color: #4f46e5; text-decoration: underline; }
        
        textarea { resize: none; font-family: 'Menlo', 'Monaco', 'Courier New', monospace; }
        /* 隐藏滚动条但保留功能 */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-gray-100 h-screen flex flex-col overflow-hidden">

    <!-- 顶部工具栏 -->
    <header class="bg-white border-b border-gray-200 h-14 flex items-center justify-between px-4 flex-shrink-0 z-10">
        <div class="flex items-center gap-2">
            <a href="/" class="text-gray-500 hover:text-gray-700 mr-2"><i class="fa-solid fa-arrow-left"></i></a>
            <h1 class="font-bold text-gray-800">Markdown Editor</h1>
        </div>
        <div class="flex gap-2">
            <button id="btn-copy-html" class="text-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded text-gray-700 transition">
                复制 HTML
            </button>
            <button id="btn-download" class="text-sm px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 rounded text-white transition">
                下载 .md
            </button>
        </div>
    </header>

    <!-- 主体编辑区 -->
    <main class="flex-grow flex flex-col md:flex-row h-full overflow-hidden">
        
        <!-- 左侧输入 -->
        <div class="w-full md:w-1/2 h-1/2 md:h-full flex flex-col border-b md:border-b-0 md:border-r border-gray-200 bg-white">
            <div class="bg-gray-50 border-b border-gray-100 px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider flex justify-between">
                <span>Markdown 输入</span>
                <span id="word-count">0 字</span>
            </div>
            <textarea id="editor" class="flex-grow p-4 w-full h-full focus:outline-none text-gray-800 text-sm leading-relaxed no-scrollbar" placeholder="# 欢迎使用 Markdown 编辑器&#10;&#10;开始在这里输入..."></textarea>
        </div>

        <!-- 右侧预览 -->
        <div class="w-full md:w-1/2 h-1/2 md:h-full flex flex-col bg-white">
            <div class="bg-gray-50 border-b border-gray-100 px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">
                预览
            </div>
            <div id="preview" class="flex-grow p-8 overflow-y-auto prose max-w-none">
                <!-- 渲染内容在这里 -->
            </div>
        </div>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const editor = document.getElementById('editor');
            const preview = document.getElementById('preview');
            const wordCount = document.getElementById('word-count');

            // 初始示例文本
            const initialText = `# 欢迎！\n\n这是一个简单的**实时 Markdown 编辑器**。\n\n- 支持标准语法\n- 左侧输入，右侧预览\n- 纯前端运行\n\n\`console.log('Hello World');\`\n`;
            editor.value = initialText;

            function render() {
                const text = editor.value;
                // 使用 marked 渲染
                preview.innerHTML = marked.parse(text);
                // 更新字数
                wordCount.textContent = text.length + ' 字';
            }

            // 实时监听
            editor.addEventListener('input', render);
            
            // 初始化渲染
            render();

            // 下载功能
            document.getElementById('btn-download').addEventListener('click', () => {
                const blob = new Blob([editor.value], {type: "text/markdown;charset=utf-8"});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = "document.md";
                a.click();
                URL.revokeObjectURL(url);
            });

            // 复制 HTML 功能
            document.getElementById('btn-copy-html').addEventListener('click', () => {
                const html = preview.innerHTML;
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = html;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);
                
                const btn = document.getElementById('btn-copy-html');
                const originalText = btn.textContent;
                btn.textContent = '已复制!';
                setTimeout(() => btn.textContent = originalText, 2000);
            });
        });
    </script>
</body>
</html>