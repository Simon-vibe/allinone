<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="tts.meta.title">Text to Speech (TTS) - Free Online Voice Reader</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üó£Ô∏è</text></svg>">
    <meta name="description"
        content="Convert text to speech instantly. Free, unlimited, and runs locally using your browser's built-in voices."
        data-i18n="tts.meta.desc">
    <meta name="keywords" content="text to speech, tts online, free tts, voice reader, speech synthesis"
        data-i18n="tts.meta.keywords">

    <!-- Canonical -->
    <link rel="canonical" href="https://allinone.page/tools/text-to-speech/">

    <!-- Hreflang -->
    <link rel="alternate" hreflang="en" href="https://allinone.page/tools/text-to-speech/" />
    <link rel="alternate" hreflang="zh" href="https://allinone.page/tools/text-to-speech/?lang=zh" />
    <link rel="alternate" hreflang="x-default" href="https://allinone.page/tools/text-to-speech/" />

    <!-- Open Graph -->
    <meta property="og:url" content="https://allinone.page/tools/text-to-speech/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Free Online Text to Speech">
    <meta property="og:description" content="Listen to any text using high-quality browser voices.">
    <meta property="og:image" content="https://allinone.page/assets/og-image.png">

    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-white py-4 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa-solid fa-screwdriver-wrench text-blue-600 text-2xl"></i>
                <a href="../../index.html" class="text-xl font-bold text-gray-900">allinone.page</a>
            </div>
            <div class="hidden md:flex items-center space-x-8 text-sm font-medium text-gray-600">
                <a href="../../index.html" class="hover:text-blue-600 transition" data-i18n="nav.home">Home</a>
                <a href="../../index.html#featured" class="hover:text-blue-600 transition"
                    data-i18n="nav.categories">Categories</a>
                <a href="../../about.html" class="hover:text-blue-600 transition" data-i18n="nav.about">About</a>
                <!-- Language Switcher Dropdown -->
                <div class="relative inline-block text-left border-l pl-6 border-gray-300">
                    <select onchange="changeLanguage(this.value)"
                        class="bg-transparent text-sm font-medium text-gray-600 hover:text-blue-600 focus:outline-none cursor-pointer">
                        <option value="en">üá∫üá∏ EN</option>
                        <option value="zh">üá®üá≥ ‰∏≠Êñá</option>
                        <option value="es">üá™üá∏ ES</option>
                        <option value="pt">üáßüá∑ PT</option>
                        <option value="id">üáÆüá© ID</option>
                        <option value="hi">üáÆüá≥ HI</option>
                        <option value="ar">üá∏üá¶ AR</option>
                    </select>
                </div>
            </div>
        </div>
    </nav>

    <!-- Tool Header -->
    <div class="bg-blue-600 text-white py-12 mb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-3xl font-bold mb-4" data-i18n="tool.tts.title">Text to Speech</h1>
            <p class="text-blue-100 max-w-2xl mx-auto" data-i18n="tool.tts.desc">Convert text to lifelike speech using
                your browser's built-in voices.</p>
        </div>
    </div>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full">

        <p class="text-gray-600 mb-8 max-w-3xl mx-auto text-center" data-i18n="tts.seo.p1">Looking for a text reader?
            Whether for accessibility, proofreading, or learning, our Text to Speech converter offers a seamless
            experience. Just paste your text and click play.</p>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
            <!-- Left: Controls -->
            <div class="lg:col-span-1 space-y-6">

                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 sticky top-6">
                    <label class="block text-sm font-bold text-gray-700 mb-2" data-i18n="tts.label.voice">Select
                        Voice</label>
                    <select id="voice-select"
                        class="w-full border border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none mb-6">
                        <option value="" disabled selected data-i18n="tts.loading.voices">Loading voices...</option>
                    </select>

                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-medium text-gray-700"
                                data-i18n="tts.label.rate">Speed</label>
                            <span id="rate-value"
                                class="text-xs text-blue-600 font-mono bg-blue-50 px-2 py-0.5 rounded">1.0x</span>
                        </div>
                        <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1"
                            class="w-full accent-blue-600 cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                            <span>0.5x</span>
                            <span>1x</span>
                            <span>2x</span>
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-medium text-gray-700"
                                data-i18n="tts.label.pitch">Pitch</label>
                            <span id="pitch-value"
                                class="text-xs text-blue-600 font-mono bg-blue-50 px-2 py-0.5 rounded">1.0</span>
                        </div>
                        <input type="range" id="pitch" min="0" max="2" value="1" step="0.1"
                            class="w-full accent-blue-600 cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                            <span>Low</span>
                            <span>Normal</span>
                            <span>High</span>
                        </div>
                    </div>
                </div>

                <div class="bg-blue-50 rounded-xl p-6 border border-blue-100 text-sm text-blue-800">
                    <i class="fa-solid fa-circle-info mr-2"></i>
                    <span data-i18n="tts.tip">Tip: Different browsers (Chrome, Safari, Edge) offer different voices. Try
                        simpler sentences for better results.</span>
                </div>

            </div>

            <!-- Right: Text Input -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 h-full flex flex-col relative">
                    <textarea id="text-input"
                        class="flex-grow w-full border-0 rounded-lg p-4 text-lg leading-relaxed outline-none resize-none focus:ring-0 min-h-[300px] text-gray-700 placeholder-gray-300"
                        placeholder="Type or paste text here to listen..."></textarea>

                    <div
                        class="absolute bottom-6 right-6 flex items-center space-x-2 bg-white/90 backdrop-blur-sm p-2 rounded-full shadow-sm border border-gray-100">
                        <div id="status-msg" class="text-xs text-gray-400 mr-2 px-2 hidden sm:block">Ready</div>

                        <button id="btn-stop"
                            class="w-10 h-10 rounded-full flex items-center justify-center text-gray-500 hover:bg-red-50 hover:text-red-500 transition"
                            title="Stop">
                            <i class="fa-solid fa-stop"></i>
                        </button>

                        <button id="btn-toggle"
                            class="bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center hover:bg-blue-700 transition shadow-lg hover:shadow-blue-200 transform hover:scale-105">
                            <i class="fa-solid fa-play text-xl pl-1" id="icon-play"></i>
                            <i class="fa-solid fa-pause text-xl hidden" id="icon-pause"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAQ & SEO -->
        <section class="max-w-4xl mx-auto mt-16 prose prose-blue text-gray-600 mb-12">
            <h2 class="text-2xl font-bold text-gray-900 mb-6" data-i18n="tts.faq.title">Text to Speech FAQ</h2>
            <p class="mb-8 text-lg leading-relaxed" data-i18n="tts.faq.desc">Browser-based text-to-speech technology
                allows you to listen to
                written content without installing any software.</p>

            <h3 class="text-xl font-bold text-gray-900 mb-4" data-i18n="tts.feat.title">Key Features</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-white p-6 rounded-lg border border-gray-100 shadow-sm">
                    <div class="text-blue-500 text-xl mb-2"><i class="fa-solid fa-sack-dollar"></i></div>
                    <p data-i18n="tts.feat.1"><strong>Free & Unlimited:</strong> No character limits.</p>
                </div>
                <div class="bg-white p-6 rounded-lg border border-gray-100 shadow-sm">
                    <div class="text-green-500 text-xl mb-2"><i class="fa-solid fa-shield-halved"></i></div>
                    <p data-i18n="tts.feat.2"><strong>Privacy:</strong> Local processing.</p>
                </div>
                <div class="bg-white p-6 rounded-lg border border-gray-100 shadow-sm">
                    <div class="text-purple-500 text-xl mb-2"><i class="fa-solid fa-language"></i></div>
                    <p data-i18n="tts.feat.3"><strong>Multiple Voices:</strong> System native voices.</p>
                </div>
                <div class="bg-white p-6 rounded-lg border border-gray-100 shadow-sm">
                    <div class="text-orange-500 text-xl mb-2"><i class="fa-solid fa-sliders"></i></div>
                    <p data-i18n="tts.feat.4"><strong>Customizable:</strong> Adjust pitch & speed.</p>
                </div>
            </div>

            <div class="space-y-6">
                <div>
                    <h4 class="font-bold text-gray-900" data-i18n="tts.faq.q1">How do I download?</h4>
                    <p data-i18n="tts.faq.a1">Use screen recording.</p>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900" data-i18n="tts.faq.q2">Supported languages?</h4>
                    <p data-i18n="tts.faq.a2">All system languages.</p>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900" data-i18n="tts.faq.q3">Different voices?</h4>
                    <p data-i18n="tts.faq.a3">Depends on OS/Browser.</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-100 pt-16 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-2 mb-4 md:mb-0">
                    <i class="fa-solid fa-screwdriver-wrench text-blue-600 text-xl"></i>
                    <a href="../../index.html" class="text-lg font-bold text-gray-900">allinone.page</a>
                </div>
                <div class="flex space-x-8 text-sm text-gray-500">
                    <a href="../../privacy.html" class="hover:text-blue-600 transition"
                        data-i18n="footer.privacy">Privacy Policy</a>
                    <a href="../../terms.html" class="hover:text-blue-600 transition" data-i18n="footer.terms">Terms of
                        Service</a>
                    <a href="../../about.html#contact" class="hover:text-blue-600 transition"
                        data-i18n="footer.contact">Contact</a>
                </div>
            </div>
            <div class="mt-8 text-center md:text-right text-xs text-gray-400" data-i18n="footer.rights">
                &copy; 2026 allinone.page. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../../js/i18n.js?v=2"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const synth = window.speechSynthesis;
            const textInput = document.getElementById('text-input');
            const voiceSelect = document.getElementById('voice-select');
            const rateInput = document.getElementById('rate');
            const pitchInput = document.getElementById('pitch');
            const rateValue = document.getElementById('rate-value');
            const pitchValue = document.getElementById('pitch-value');

            const btnToggle = document.getElementById('btn-toggle');
            const iconPlay = document.getElementById('icon-play');
            const iconPause = document.getElementById('icon-pause');
            const btnStop = document.getElementById('btn-stop');
            const statusMsg = document.getElementById('status-msg');

            let voices = [];
            let currentUtterance = null;

            // Page Exit / Unload - Stop playback
            window.addEventListener('beforeunload', () => {
                if (synth.speaking) {
                    synth.cancel();
                }
            });

            // Visibility Change - Stop playback if user leaves tab (Optional, but "Stop on page exit" usually implies navigation. 
            // User might want to listen in background tab, so we ONLY stop on actual unload/navigation).
            // However, user said "Leaving this page... continue playing is bad experience".
            // Implementation of `beforeunload` covers navigation/close. 
            // If they mean "switch tabs", that's `visibilitychange`. I'll stick to `beforeunload` as it's safer for "listening while working in other tabs".

            function populateVoices() {
                voices = synth.getVoices();
                if (voices.length === 0) return;

                voiceSelect.innerHTML = '';

                // Get current page language
                const urlParams = new URLSearchParams(window.location.search);
                const pageLang = urlParams.get('lang') || 'en'; // Simple detection

                // Sort: put voices matching page language first
                voices.sort((a, b) => {
                    const aLangMatch = a.lang.toLowerCase().includes(pageLang);
                    const bLangMatch = b.lang.toLowerCase().includes(pageLang);

                    if (aLangMatch && !bLangMatch) return -1;
                    if (!aLangMatch && bLangMatch) return 1;
                    return a.name.localeCompare(b.name);
                });

                let defaultFound = false;

                voices.forEach((voice) => {
                    const option = document.createElement('option');
                    // Clean up voice name for display
                    option.textContent = `${voice.name} (${voice.lang})`;
                    option.setAttribute('data-name', voice.name);
                    option.setAttribute('data-lang', voice.lang);

                    // Auto-select logic
                    // 1. Try to match exact page language (e.g. 'zh-CN')
                    // 2. Try to match base language (e.g. 'zh')

                    if (!defaultFound) {
                        if (voice.lang.toLowerCase().includes(pageLang)) {
                            option.selected = true;
                            defaultFound = true;
                        }
                    }

                    voiceSelect.appendChild(option);
                });
            }

            populateVoices();
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = populateVoices;
            }

            function setStatus(state) {
                if (state === 'playing') {
                    iconPlay.classList.add('hidden');
                    iconPause.classList.remove('hidden');
                    statusMsg.textContent = "Speaking...";
                } else if (state === 'paused') {
                    iconPlay.classList.remove('hidden');
                    iconPause.classList.add('hidden');
                    statusMsg.textContent = "Paused";
                } else {
                    iconPlay.classList.remove('hidden');
                    iconPause.classList.add('hidden');
                    statusMsg.textContent = "Ready";
                }
            }

            function speak() {
                if (synth.speaking) {
                    console.error('speechSynthesis.speaking');
                    return;
                }
                const text = textInput.value.trim();
                if (text !== '') {
                    const utterThis = new SpeechSynthesisUtterance(text);
                    const selectedOption = voiceSelect.selectedOptions[0]?.getAttribute('data-name');

                    if (selectedOption) {
                        for (let i = 0; i < voices.length; i++) {
                            if (voices[i].name === selectedOption) {
                                utterThis.voice = voices[i];
                                break;
                            }
                        }
                    }

                    utterThis.pitch = pitchInput.value;
                    utterThis.rate = rateInput.value;

                    utterThis.onstart = () => {
                        setStatus('playing');
                    };

                    utterThis.onend = () => {
                        setStatus('stopped');
                    };

                    utterThis.onerror = (event) => {
                        console.error('SpeechSynthesisUtterance.onerror', event);
                        setStatus('stopped');
                    };

                    currentUtterance = utterThis;
                    synth.speak(utterThis);
                }
            }

            // Controls
            btnToggle.addEventListener('click', () => {
                if (synth.speaking) {
                    if (synth.paused) {
                        synth.resume();
                        setStatus('playing');
                    } else {
                        synth.pause();
                        setStatus('paused');
                    }
                } else {
                    speak();
                }
            });

            btnStop.addEventListener('click', () => {
                synth.cancel();
                setStatus('stopped');
            });

            // Real-time Adjustment
            // Since Web Speech API doesn't support changing rate/pitch mid-utterance, we must restart.
            const restartSpeech = () => {
                if (synth.speaking) {
                    synth.cancel();
                    // Needs a small timeout for generic browsers to clear the buffer
                    setTimeout(() => {
                        speak();
                    }, 50);
                }
            };

            // Debounce to prevent rapid restarts while dragging
            let debounceTimer;
            const handleAdjustment = (e, targetDisplay) => {
                targetDisplay.textContent = e.target.value + (targetDisplay === rateValue ? 'x' : '');

                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    if (synth.speaking && !synth.paused) {
                        restartSpeech();
                    }
                }, 300); // 300ms wait after drag stops
            };

            rateInput.addEventListener('input', (e) => handleAdjustment(e, rateValue));
            pitchInput.addEventListener('input', (e) => handleAdjustment(e, pitchValue));
        });
    </script>
</body>

</html>